{% extends 'base.html' %}
{% load synopsis_tags %}
{% load static %}
{% block title %}
  {% if user.is_authenticated %}
  - Welcome {{user.first_name}}
  {%else%}
    - Please Login
  {% endif %}
{% endblock title %}


{% block content %}
<div>
  <h4 class="main-titles" style="margin-bottom:1%;">Synopsis</h4>
</div>
<br/>
{% if user.is_authenticated %}
<section class = 'home-section'>
  {% for book in pages %}
    {% test_tag book.id user.id%}
      <h6>We found {{ total_books }} new realeases in
        {%for i in genre_objs%}
          {% if forloop.last %}
            {{i.ght}}...
          {% else %}
          {{i.ght}} &
          {% endif %}
        {% endfor %} 
      </h6>
    <div class="synopsis-books-book-wrapper">
      <div class='synopsis-info'>
        <div class="synopsis-book-info-text">
          <h6>{{book.synopsis|slice:":700"}}...</h6>
        </div>
        <div class='synopsis-image'>
          <div class="book-image">
            <img itemprop="image" id="scope_book_image" class="js-open-modal" data-modal-id="zoomModal"
              src="{{book.img_link}}" data-zoom-src="{{book.img_link}}" alt="{{book.title}}" onerror="imgError(this)"
              width="200" style="border-radius:15px;">
          </div>
        </div>
      </div>
      <div class="synopsis-buttons">
        <div class="button-array">
          {%if pages.has_next %}
          <div class='next-button'>
          <a class='genre-button' type="submit" href="?page={{ pages.next_page_number }}"><img id='no-button' src="{% static 'images/No.svg' %}"></a>
          </div>
          {%else%}
          <div class='next-button'>
            <a class='genre-button' type="submit" href="{% url 'the_last_page' selected_genres %}"><img id='no-button' src="{% static 'images/No.svg' %}"></a>
            </div>
          {% endif %}
          <div>
            <form action="{% url 'like_book' book.id  %}" method="POST" class='synopsis-form'>
              {% csrf_token %}
              <div>
                <!-- if liked by user == True-->
                {% if liked == True %}
                <h5><button class='genre-button' type="submit" name="book.id" value="{{book.id}}">Remove from The Maybe Pile</button></h5>
                {% else %}
                <h5><button class='genre-button' type="submit" name="book.id" value="{{book.id}}"><img id='heart-button' src="{% static 'images/heart.svg' %}"></button>
                </h5>
                {% endif %}
              </div>
            </form>
          </div>
        </div>
        <br/>
      </div>
  {% endfor %}

</section>
<!--
{{ pages }}<br/>
Has Next : {{pages.has_next}}<br/>
Has Prev : {{pages.has_previous}}<br/>
Current : {{pages.number}}<br/>
Total : {{pages.paginator.num_pages}}<br/>
-->
{% else %}
  <h3> Please Login to view this page...</h3>
{% endif %}
  
{% endblock content%}



